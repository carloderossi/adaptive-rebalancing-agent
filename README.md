# ğŸ“˜ **Adaptive Portfolio Rebalancing Agent**

## ğŸ§  Overview

**Adaptive Portfolio Rebalancing Agent** is a multiâ€‘agent system that automates the detection, analysis, and recommendation of portfolio rebalancing opportunities for wealth advisors.  
Instead of manually reviewing each client portfolio, advisors receive **proactive, personalized, taxâ€‘aware rebalancing scenarios** generated by a coordinated team of AI agents.

The system uses:

- **LangGraph** for agent orchestration  
- **Ollamaâ€‘hosted LLMs** (Qwen, DeepSeek, Mistral) for reasoning & explanation  
- **PyPortfolioOpt** for optimization  
- **Streamlit** for the advisor dashboard  
- **YAMLâ€‘based model configuration**  
- **Sample portfolios** stored offline for demos and testing  

This project turns rebalancing from a **reactive, manual task** into a **proactive, explainable, advisorâ€‘friendly workflow**.

---

## ğŸš€ Key Features

### ğŸ” **1. Continuous Monitoring**
The **Monitor Agent** evaluates:

- Drift from target allocation  
- Assetâ€‘class imbalances  
- Threshold triggers (e.g., >5% drift)  

If drift is below threshold â†’ no action needed.

---

### ğŸ§® **2. LLMâ€‘Powered Portfolio Analysis**
The **Analyst Agent** (LLMâ€‘driven) evaluates:

- Portfolio composition  
- Market context (volatility, concentration, red flags)  
- Tax considerations  
- Risk bounds based on client profile  

Output is structured JSON used by downstream agents.

---

### ğŸ§  **3. Multiâ€‘Scenario Strategy Generation**
The **Strategist Agent** combines:

- LLM planning  
- PyPortfolioOpt heuristics  
- Deterministic trade construction  

It generates **3 scenarios**:

- **Conservative** (light drift correction)  
- **Moderate**  
- **Aggressive** (full realignment)  

Each scenario includes:

- Target allocation  
- Concrete trades (buy/sell)  
- Estimated tax impact  
- Expected risk reduction  

---

### ğŸ—£ï¸ **4. Advisorâ€‘Friendly Explanations**
The **Explainer Agent** uses an LLM to produce:

- Clear, concise summaries  
- Plainâ€‘language rationale  
- Risk & tax implications  
- Alignment with client profile  

Perfect for advisor communication.

---

### ğŸ•¸ï¸ **5. LangGraph Orchestration**
The **Orchestrator** coordinates:

1. Monitor â†’  
2. Analyst â†’  
3. Strategist â†’  
4. Explainer  

With conditional routing:

- If no drift â†’ stop early  
- If drift â†’ full pipeline  

---

### ğŸ–¥ï¸ **6. Streamlit Dashboard**
The UI provides:

- Portfolio upload or sample portfolio selection  
- Realâ€‘time progress bar + spinner  
- Scenario comparison  
- Approve / Modify / Reject actions  
- Allocation charts  
- Trade breakdowns  

---

### ğŸ“ **7. Offline Sample Portfolios**
A curated library of realistic portfolios:

- Conservative  
- Balanced  
- Aggressive  
- Randomized sets  

Stored in `sample_portfolios/` as CSV files.

---

## ğŸ§± Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Streamlit UI        â”‚
â”‚  (Upload / Select / Run) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   LangGraph Orchestrator â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼        â–¼        â–¼        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Monitor â”‚ â”‚Analyst â”‚ â”‚Strateg â”‚ â”‚Explainer â”‚
â”‚ Agent  â”‚ â”‚ Agent  â”‚ â”‚ Agent  â”‚ â”‚  Agent   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚        â”‚        â”‚        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Final Output
```

---

## ğŸ§© Agent Responsibilities

### **Monitor Agent**
- Computes drift  
- Compares to thresholds  
- Decides whether to trigger rebalancing  

### **Analyst Agent (LLM)**
- Market context  
- Tax considerations  
- Risk bounds  
- JSON output for strategist  

### **Strategist Agent (LLM + PyPortfolioOpt)**
- Designs 3 scenarios  
- Builds target allocations  
- Generates trades  
- Estimates tax & risk impact  

### **Explainer Agent (LLM)**
- Converts structured data into advisorâ€‘friendly text  

---

## âš™ï¸ Tech Stack

| Component | Technology |
|----------|------------|
| Agent Orchestration | **LangGraph** |
| LLMs | **Ollama** (Qwen, DeepSeek, Mistral) |
| Optimization | **PyPortfolioOpt** |
| Dashboard | **Streamlit** |
| Config | **YAML** |
| Data | Offline sample portfolios + CSV uploads |
| Deployment | Local or Docker |

---

## ğŸ“¦ Installation

### 1. Clone the repo

```bash
git clone https://github.com/yourname/adaptive-rebalancing-agent.git
cd adaptive-rebalancing-agent
```

### 2. Install dependencies with `uv`

```bash
uv sync
```

### 3. Pull required Ollama models

```bash
ollama pull qwen2.5-coder:14b
ollama pull deepseek-coder-v2:16b
ollama pull mistral:7b
```

### 4. Generate sample portfolios (optional)

```bash
uv run python generate_sample_portfolios.py
```

---

## â–¶ï¸ Running the App

```bash
uv run streamlit run app.py
```

Then open:

```
http://localhost:8501
```

---

## ğŸ§ª Sample Portfolio Library

Stored in:

```
sample_portfolios/
â”œâ”€â”€ conservative.csv
â”œâ”€â”€ balanced.csv
â”œâ”€â”€ aggressive.csv
â”œâ”€â”€ random_1.csv
â”œâ”€â”€ random_2.csv
â””â”€â”€ ...
```

Load them directly from the sidebar.

---

## ğŸ“ˆ Success Metrics

- **95%** detection of portfolios needing rebalancing  
- **70%** reduction in advisor analysis time  
- **60%+** advisor acceptance rate of recommended scenarios  
- **4.5/5** explainability score  

---

## ğŸ›£ï¸ Roadmap

- [ ] Add advisor preference learning  
- [ ] Add taxâ€‘loss harvesting module  
- [ ] Add market shock simulator  
- [ ] Add realâ€‘time streaming of agent execution  
- [ ] Add PDF export of recommendations  
- [ ] Add multiâ€‘client batch processing  

---

## ğŸ¤ Contributing

Pull requests are welcome!  
Please open an issue to discuss major changes.

---

## ğŸ“„ License

MIT License

---
